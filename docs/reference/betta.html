<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Modelling total diversity with betta — betta • breakaway</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Modelling total diversity with betta — betta" />
<meta property="og:description" content="This function tests for heterogeneity of total diversity (observed plus
unobserved) across multiple sites. It can account or test for fixed effects
that may explain diversity. It returns the significance of the covariates in
explaining diversity and a hypothesis test for heterogeneity." />
<meta property="og:image" content="http://adw96.github.io/breakaway/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">breakaway</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.7.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/breakaway.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/diversity-hypothesis-testing.html">Introduction to hypothesis testing for diversity</a>
    </li>
    <li>
      <a href="../articles/intro-diversity-estimation.html">Introduction to diversity estimation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/adw96/breakaway/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Modelling total diversity with betta</h1>
    <small class="dont-index">Source: <a href='https://github.com/adw96/breakaway/blob/master/R/model_betta.R'><code>R/model_betta.R</code></a></small>
    <div class="hidden name"><code>betta.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function tests for heterogeneity of total diversity (observed plus
unobserved) across multiple sites. It can account or test for fixed effects
that may explain diversity. It returns the significance of the covariates in
explaining diversity and a hypothesis test for heterogeneity.</p>
    </div>

    <pre class="usage"><span class='fu'>betta</span><span class='op'>(</span>
  chats <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>ses</span>,
  X <span class='op'>=</span> <span class='cn'>NULL</span>,
  initial_est <span class='op'>=</span> <span class='cn'>NULL</span>,
  formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  data <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>chats</th>
      <td><p>A vector of estimates of total diversity at different sampling
locations. <samp>breakaway</samp> estimates are suggested in the high-diversity
case but not enforced.</p></td>
    </tr>
    <tr>
      <th>ses</th>
      <td><p>The standard errors in <code>chats</code>, the diversity estimates. This
can either be a vector of standard errors (with the arguments <code>chats</code> and 
<code>X</code>), or the name of the variable in the dataframe <code>data</code> that contains 
the standard errors (with the arguments <code>formula</code> and <code>data</code>).</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>A numeric matrix of covariates. If not supplied, an intercept-only
model will be fit. This is optional with the <code>chats</code> argument.</p></td>
    </tr>
    <tr>
      <th>initial_est</th>
      <td><p>(Optional) A vector of length 1 + ncol(X) giving the starting values for the likelihood maximisation search. The first element is the starting estimate for sigma^2_u, and the remaining elements are the starting elements for beta. Defaults to NULL, in which case the starting values outlined in the paper are used.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>A formula object of the form \(y ~ x | group\). Required with 
the <code>data</code> argument.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A dataframe containing the response, response standard errors, covariates, 
and grouping variable. Required with the <code>formula</code> argument.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>table</dt><dd><p>A coefficient table for the model parameters. The
columns give the parameter estimates, standard errors, and p-values,
respectively. This model is only as effective as your diversity estimation
procedure; for this reason please confirm that your estimates are
appropriate and that your model is not misspecified. betta_pic may be
useful for this purpose.</p></dd> <dt>cov</dt><dd><p>Estimated covariance matrix of the
parameter estimates.</p></dd> <dt>ssq_u</dt><dd><p>The estimate of the heterogeneity
variance.</p></dd> <dt>homogeneity</dt><dd><p>The test statistic and p-value for the test
of homogeneity.</p></dd> <dt>global</dt><dd><p>The test statistic and p-value for the
test of model explanatory power.</p></dd> <dt>blups</dt><dd><p>The conditional expected
values of the diversity estimates (conditional on the random effects). The
authors propose that if the practitioner believes that information from one
diversity estimator may inform the others, then using the <samp>condfits</samp> as
estimators of total diversity rather than <samp>Chats</samp> may reduce variance
of diversity estimates by ``sharing strength'' across the samples.</p></dd>
<dt>blupses</dt><dd><p>The estimated standard deviation (standard errors) in the
blups.</p></dd>
<dt>loglikelihood</dt><dd><p>The log likelihood of the fitted model.</p></dd>
<dt>aic</dt><dd><p>The Akaike information criterion for the fitted model.</p></dd>
<dt>aicc</dt><dd><p>The finite sample correction of the Akaike information criterion for the fitted model.</p></dd>
<dt>r_squared_wls</dt><dd><p>The weighted R^2 statistic, appropriate for heteroskedastic linear models.</p></dd>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Ecologists who are interested in the way species richness varies with
covariate information often run a regression-type analysis on the observed
diversity using their covariate information as predictors. However, in many
settings (especially microbial), rare and unobserved taxa play a hugely
important role in explaining the subtleties of the ecosystem, however, a
regression analysis on the observed diversity level fails to account for
these unobserved taxa. By predicting the total level of diversity (for
example, via <code><a href='breakaway.html'>breakaway</a></code>) and estimating the standard error in
the estimate, one can take account of these unobserved, but important, taxa.
In order to account for the estimated nature of the response, a mixed model
approach is taken, whereby the varying levels of confidence in the estimates
contributes to a diagonal but heteroscedastic covariance matrix. Given
covariates constitute the fixed effects in the mixed model, and significance
of the random effect term ``sigsq_u'' reflects heterogeneity in the sample,
that is, variability that cannot be explained by only the covariates. The
authors believe this to be the first attempt at modelling total diversity in
a way that accounts for its estimated nature.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Willis, A., Bunge, J., and Whitman, T. (2015). Inference for
changes in biodiversity. <em>arXiv preprint.</em></p>
<p>Willis, A. and Bunge, J. (2015). Estimating diversity via frequency ratios.
<em>Biometrics.</em></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='breakaway.html'>breakaway</a></code>; <code><a href='breakaway_nof1.html'>breakaway_nof1</a></code>;
<code><a href='apples.html'>apples</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Amy Willis</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
















<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>chats <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2000</span>, <span class='fl'>3000</span>, <span class='fl'>4000</span>, <span class='fl'>3000</span><span class='op'>)</span>, ses <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>150</span>, <span class='fl'>180</span><span class='op'>)</span>,
                 Cont_var <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>150</span>, <span class='fl'>100</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># formula notation </span>
<span class='fu'>betta</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>chats</span> <span class='op'>~</span> <span class='va'>Cont_var</span>, ses <span class='op'>=</span> <span class='va'>ses</span>, data <span class='op'>=</span> <span class='va'>df</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $table
#&gt;                Estimates Standard Errors p-values
#&gt; (Intercept) 2.995149e+03      416.145952        0
#&gt; Cont_var    1.730997e-03        3.931275        1
#&gt; 
#&gt; $cov
#&gt;             (Intercept)    Cont_var
#&gt; (Intercept)  1575149.61 -14038.4223
#&gt; Cont_var      -14038.42    140.5715
#&gt; 
#&gt; $ssq_u
#&gt; [1] 666667.8
#&gt; 
#&gt; $homogeneity
#&gt; [1] 143.9291   0.0000
#&gt; 
#&gt; $global
#&gt; [1] 5.180787e+01 6.120660e-13
#&gt; 
#&gt; $blups
#&gt; [1] 2014.709 2999.740 3967.199 2999.779
#&gt; 
#&gt; $blupses
#&gt; [1]  99.44868 198.55147 148.15536 178.94475
#&gt; 
#&gt; $loglikelihood
#&gt; [1] -32.03712
#&gt; 
#&gt; $aic
#&gt; [1] 70.07423
#&gt; 
#&gt; $aicc
#&gt; [1] Inf
#&gt; 
#&gt; $r_squared_wls
#&gt; [1] -4.376681e-05
#&gt; </div><div class='input'>
<span class='co'># direct input </span>
<span class='fu'>betta</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2000</span>, <span class='fl'>3000</span>, <span class='fl'>4000</span>, <span class='fl'>3000</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>150</span>, <span class='fl'>180</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>150</span>, <span class='fl'>100</span>, 
    <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $table
#&gt;         Estimates Standard Errors p-values
#&gt; [1,] 2.995149e+03      416.145952        0
#&gt; [2,] 1.730997e-03        3.931275        1
#&gt; 
#&gt; $cov
#&gt;            [,1]        [,2]
#&gt; [1,] 1575149.61 -14038.4223
#&gt; [2,]  -14038.42    140.5715
#&gt; 
#&gt; $ssq_u
#&gt; [1] 666667.8
#&gt; 
#&gt; $homogeneity
#&gt; [1] 143.9291   0.0000
#&gt; 
#&gt; $global
#&gt; [1] 5.180787e+01 6.120660e-13
#&gt; 
#&gt; $blups
#&gt; [1] 2014.709 2999.740 3967.199 2999.779
#&gt; 
#&gt; $blupses
#&gt; [1]  99.44868 198.55147 148.15536 178.94475
#&gt; 
#&gt; $loglikelihood
#&gt; [1] -32.03712
#&gt; 
#&gt; $aic
#&gt; [1] 70.07423
#&gt; 
#&gt; $aicc
#&gt; [1] Inf
#&gt; 
#&gt; $r_squared_wls
#&gt; [1] -4.376681e-05
#&gt; </div><div class='input'>
<span class='co'>## handles missing data</span>
<span class='fu'>betta</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2000</span>, <span class='fl'>3000</span>, <span class='fl'>4000</span>, <span class='fl'>3000</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>150</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $table
#&gt;      Estimates Standard Errors p-values
#&gt; [1,]      3000        584.2429        0
#&gt; 
#&gt; $cov
#&gt;          [,1]
#&gt; [1,] 341339.7
#&gt; 
#&gt; $ssq_u
#&gt; [1] 1e+06
#&gt; 
#&gt; $homogeneity
#&gt; [1] 144.4444   0.0000
#&gt; 
#&gt; $global
#&gt; [1] 26.36669  0.00000
#&gt; 
#&gt; $blups
#&gt; [1] 2009.901 3000.000 3977.995       NA
#&gt; 
#&gt; $blupses
#&gt; [1]  99.67172 197.39929 148.89651        NA
#&gt; 
#&gt; $loglikelihood
#&gt; [1] -24.49984
#&gt; 
#&gt; $aic
#&gt; [1] 52.99968
#&gt; 
#&gt; $aicc
#&gt; [1] Inf
#&gt; 
#&gt; $r_squared_wls
#&gt; [1] -2.220446e-16
#&gt; </div><div class='input'>
<span class='co'>## A test for heterogeneity of apples diversity estimates vs butterfly estimates</span>
<span class='fu'>betta</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1552</span>, <span class='fl'>1500</span>, <span class='fl'>884</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>305</span>, <span class='fl'>675</span>, <span class='fl'>205</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $table
#&gt;      Estimates Standard Errors p-values
#&gt; [1,]      1526        294.0600     0.00
#&gt; [2,]      -642        424.3689     0.13
#&gt; 
#&gt; $cov
#&gt;           [,1]      [,2]
#&gt; [1,]  166341.7 -166341.7
#&gt; [2,] -166341.7  346430.7
#&gt; 
#&gt; $ssq_u
#&gt; [1] 138064
#&gt; 
#&gt; $homogeneity
#&gt; [1] 0.008750509 0.925471271
#&gt; 
#&gt; $global
#&gt; [1] 1.833863e+01 1.849194e-05
#&gt; 
#&gt; $blups
#&gt; [1] 1541.534 1519.954  884.000
#&gt; 
#&gt; $blupses
#&gt; [1] 287.2854 451.5839 205.0000
#&gt; 
#&gt; $loglikelihood
#&gt; [1] -21.63179
#&gt; 
#&gt; $aic
#&gt; [1] 49.26357
#&gt; 
#&gt; $aicc
#&gt; [1] 25.26357
#&gt; 
#&gt; $r_squared_wls
#&gt; [1] 0.9951037
#&gt; </div><div class='input'>





















</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Amy Willis, Bryan D Martin, Pauline Trinh, Sarah Teichman, David Clausen, Kathryn Barger, John Bunge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


